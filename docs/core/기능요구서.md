# EduCanvas 기능요구서 v4.1

**작성일**: 2025-08-10  
**최종 업데이트**: 2025-08-10  
**프로젝트**: EduCanvas 학원관리 시스템  
**버전**: v4.1 (멀티테넌트 + YouTube 통합)  
**데이터베이스**: database_schema_v4.1_video_integrated.sql

---

## 📋 목차

1. [프로젝트 개요](#1-프로젝트-개요)
2. [MVP 핵심 기능 (P0)](#2-mvp-핵심-기능-p0)
3. [확장 기능 (Phase 4-10)](#3-확장-기능-phase-4-10)
4. [사용자 역할 및 권한](#4-사용자-역할-및-권한)
5. [기능별 상세 요구사항](#5-기능별-상세-요구사항)
6. [성능 및 기술 요구사항](#6-성능-및-기술-요구사항)

---

## 1. 프로젝트 개요

### 1.1 프로젝트 목표
**"직관적이고 강력한 드래그앤드롭 기반 학원 관리 시스템"**

- **주요 가치**: 복잡한 학원 운영을 간단하게 만드는 혁신적 UI/UX
- **킬러 기능**: ClassFlow - 드래그앤드롭으로 학생을 자유롭게 이동하는 직관적 반 관리
- **대상 시장**: 소/중규모 학원 (학생 100-1000명 규모)
- **핵심 차별화**: 기존 학원 관리 프로그램 대비 10배 쉬운 사용성

### 1.2 기술 스택 (v4.1)
- **Frontend**: Next.js 15 + React 19 + TailwindCSS 4
- **Backend**: Supabase (PostgreSQL + Auth + Realtime + Edge Functions)
- **State**: Zustand
- **DnD**: @dnd-kit
- **Validation**: Zod + React Hook Form
- **Video**: YouTube API v3 + 커스텀 플레이어
- **Multi-tenant**: Row Level Security (RLS)
- **Analytics**: 실시간 학습 분석 대시보드

### 1.3 성공 지표 (v4.1)
- **사용성**: 신규 사용자 5분 내 기본 조작 학습
- **성능**: 1000명 학생 데이터에서 드래그앤드롭 60fps 유지
- **안정성**: 99.9% 가동률, 데이터 무결성 100%
- **멀티테넌트**: 무제한 학원 동시 지원, 완전한 데이터 격리
- **비디오 학습**: YouTube 비디오 실시간 진도 추적
- **확장성**: 테넌트당 최대 10,000명 학생 지원

---

## 2. MVP 핵심 기능 (P0) - v4.1 업데이트

### 2.1 **멀티테넌트 아키텍처** (신규 P0)
- **테넌트 관리**: 학원별 완전 격리, 구독 계층 관리
- **사용자 역할**: Owner/Admin/Instructor/Staff/Viewer 5단계
- **권한 시스템**: 세밀한 리소스별 접근 제어
- **보안**: Row Level Security 완전 적용

### 2.2 **YouTube 비디오 학습 시스템** (신규 P0)
- **비디오 관리**: YouTube API 완전 통합, 메타데이터 자동 동기화
- **진도 추적**: 실시간 시청 진도, 완료율 분석
- **학습 분석**: AI 기반 학습 패턴 분석 및 개선 제안
- **상호작용**: 댓글, 질문, 북마크, 노트 시스템

### 2.3 **기존 MVP 기능들** (v4.1 업그레이드)
- **ClassFlow**: 드래그앤드롭 + 멀티테넌트 지원
- **학생 관리**: 테넌트별 격리 + 비디오 학습 연동
- **강사 관리**: 테넌트별 권한 + 비디오 과제 배정
- **결제 관리**: 테넌트별 분리 + 구독 결제 연동
- **권한 관리**: 멀티테넌트 RBAC 완전 구현

## 3. 확장 기능 (Phase 4-10) - v4.1 스키마 기반

### 3.1 교실 관리 시스템 (Phase 4)
- **물리적 교실 정보 관리**: 수용 인원, 시설, 적합 과목
- **교실 예약 시스템**: 충돌 방지, 자동 배정
- **사용률 분석**: 교실별 가동률 및 효율성 분석
- **QR 코드 체크인**: 모바일 기반 교실 확인

### 3.2 타임테이블 관리 (Phase 4)  
- **시간 슬롯 관리**: 유연한 시간 설정 (90분, 120분 등)
- **정규 시간표**: 반복 스케줄 관리
- **스케줄 변경**: 보강, 휴강, 교실 변경
- **드래그앤드롭 시간표**: 직관적인 시간표 편집
- **AI 자동 최적화**: 최적 시간표 자동 생성

### 3.3 성적 관리 시스템 (Phase 5)
- **유연한 시험 구조**: 다양한 시험 유형 지원
- **문제 관리**: 객관식, 주관식, 서술형 등
- **자동 성적 분석**: 등급, 순위, 백분위 계산
- **학습 진도 추적**: AI 기반 성취도 분석
- **성적표 자동 생성**: PDF 생성 및 공유

### 3.4 문서 저장 시스템 (Phase 5)
- **계층적 폴더 구조**: 권한별 접근 제어
- **파일 버전 관리**: 변경 이력 추적
- **OCR 텍스트 추출**: 이미지/PDF 검색 가능
- **태그 및 검색**: AI 기반 자동 분류
- **접근 로그**: 문서 사용 통계

### 3.5 학생 히스토리 시스템 (Phase 5)
- **통합 이벤트 추적**: 모든 학생 활동 기록
- **AI 학습 분석**: 개인별 학습 패턴 분석
- **예측 분석**: 성과 예측 및 위험 학생 식별
- **개선 방안 제시**: 맞춤형 학습 가이드
- **감사 로그**: 완전한 변경 이력

### 3.6 상담 관리 시스템 (Phase 5)
- **상담 예약**: 다양한 상담 유형 지원
- **참석자 관리**: 학생, 학부모, 강사 참석 관리
- **상담 기록**: 체계적인 상담 내용 관리
- **효과 분석**: 상담 만족도 및 효과성 추적
- **후속 조치**: 자동 리마인더 및 후속 상담

MVP에서 구현할 필수 기능들입니다.

| 기능 | 우선순위 | 개발 기간 | 설명 |
|------|----------|-----------|------|
| **🎯 ClassFlow** | P0 | 3주 | 드래그앤드롭 반별 학생 관리 (킬러 컨텐츠) |
| **👥 학생 관리** | P0 | 2주 | CRUD, 출결, 상태 관리 |
| **👨‍🏫 강사 관리** | P0 | 1주 | 기본 정보, 반 배정, 급여 정책 |
| **💳 결제 관리** | P0 | 3주 | 다양한 수강권, 결제 처리 (schema_v2 기반) |
| **🔐 권한 관리** | P0 | 1주 | RBAC 기반 사용자 접근 제어 |

**총 개발 기간**: 10주 (2.5개월)

---

## 3. 사용자 역할 및 권한

### 3.1 사용자 역할 정의

#### 3.1.1 관리자 (Admin)
- **대상**: 학원장, 부원장
- **권한**: 모든 기능 접근, 강사/직원 관리, 급여/정산 관리
- **주요 업무**: 전체 운영 관리, 의사결정, 성과 분석

#### 3.1.2 강사 (Instructor)  
- **대상**: 전임/파트타임 강사
- **권한**: 담당 반 학생만 조회/수정, 출결 관리, 성적 입력
- **주요 업무**: 수업 진행, 출결 체크, 학생 상담

#### 3.1.3 직원 (Staff)
- **대상**: 상담사, 사무직원
- **권한**: 학생 등록/수정, 상담 기록, 결제 처리
- **주요 업무**: 신규 상담, 학생 관리, 결제 업무

#### 3.1.4 조회자 (Viewer)
- **대상**: 임시직, 인턴
- **권한**: 읽기 전용
- **주요 업무**: 정보 조회, 보고서 확인

### 3.2 권한 매트릭스

| 기능 | Admin | Instructor | Staff | Viewer |
|------|-------|------------|-------|--------|
| ClassFlow (학생 이동) | ✅ | 담당 반만 | ✅ | ❌ |
| 학생 정보 조회 | ✅ | 담당 학생만 | ✅ | ✅ |
| 학생 정보 수정 | ✅ | 담당 학생만 | ✅ | ❌ |
| 출결 관리 | ✅ | 담당 반만 | ✅ | ❌ |
| 결제 관리 | ✅ | ❌ | ✅ | ❌ |
| 강사 관리 | ✅ | ❌ | ❌ | ❌ |
| 급여 관리 | ✅ | 본인 것만 | ❌ | ❌ |
| 통계/분석 | ✅ | 담당 분만 | 제한적 | 제한적 |

---

## 4. 기능별 상세 요구사항

### 4.1 🎯 ClassFlow (핵심 킬러 기능)

#### 4.1.1 개요
**"마치 게임처럼 직관적인 학생 배치 시스템"**

학생 카드를 드래그하여 반 사이를 자유롭게 이동시킬 수 있는 혁신적인 인터페이스입니다.

#### 4.1.2 핵심 기능
```yaml
드래그앤드롭 이동:
  - 학생 카드를 드래그하여 다른 반으로 이동
  - 실시간 이동 가능성 검증 (정원 초과 방지)
  - 부드러운 애니메이션 (60fps)
  - 되돌리기 기능 지원

시각적 피드백:
  - 이동 가능한 반: 녹색 하이라이트
  - 이동 불가능한 반: 빨간색 하이라이트  
  - 정원 초과 시: 경고 메시지
  - 이동 완료 시: 성공 알림

반 정보 실시간 업데이트:
  - 현재 학생 수 / 최대 학생 수 표시
  - 수강료 총액 자동 계산
  - 강사별 담당 학생 수 업데이트
```

#### 4.1.3 기술 요구사항
```yaml
성능:
  - 1000명 학생에서 드래그 응답시간 < 100ms
  - 60fps 부드러운 애니메이션 유지
  - 메모리 사용량 < 200MB

접근성:
  - 키보드 네비게이션 지원 (Tab, Arrow keys, Enter)
  - 스크린 리더 완벽 지원
  - 터치 디바이스 최적화 (모바일/태블릿)

브라우저 지원:
  - Chrome, Firefox, Safari, Edge (최신 3버전)
  - iOS Safari, Android Chrome
```

#### 4.1.4 UI/UX 설계
```yaml
레이아웃:
  - 왼쪽: 반 목록 (세로 스크롤)
  - 오른쪽: 선택된 반의 학생 목록 (그리드)
  - 상단: 검색/필터 도구모음

학생 카드:
  - 이름, 학년, 연락처 표시
  - 출결 상태 색상 표시 (출석: 초록, 결석: 빨강)
  - 수강권 잔여 정보 (10회 중 3회 남음)
  - 사진 썸네일 (선택사항)

반 박스:
  - 반 이름, 강사명 표시
  - 현재 인원 / 최대 인원
  - 수업 시간 표시
  - 색상 테마 적용
```

### 4.2 👥 학생 관리

#### 4.2.1 학생 등록
```yaml
필수 정보:
  - 이름 (한글/영문)
  - 연락처 (학생 핸드폰)
  - 보호자명
  - 보호자 연락처 (필수)
  - 학년 (초1~고3, 재수생 등)

선택 정보:
  - 학교명
  - 주소
  - 생년월일
  - 특이사항 메모
  - 사진

등록 프로세스:
  1. 기본 정보 입력
  2. 초기 반 배정 (또는 대기)
  3. 수강권 선택 및 결제
  4. 등록 완료 → ClassFlow에서 확인
```

#### 4.2.2 학생 상태 관리
```yaml
상태 유형:
  - active: 재학중 (수업 출석 가능)
  - waiting: 대기중 (반 배정 대기)
  - inactive: 휴학중 (일시 중단)
  - graduated: 졸업/수료

상태 변경:
  - 드롭다운 메뉴로 간편 변경
  - 변경 사유 기록
  - 변경 이력 추적
  - 자동 알림 (학부모 SMS)
```

#### 4.2.3 출결 관리
```yaml
출결 체크:
  - 반별 출석부 화면
  - 클릭으로 간편 체크 (출석/지각/결석/사유결석)
  - 체온 기록 (코로나 대응)
  - 일괄 처리 (전체 출석 등)

출결 현황:
  - 학생별 출석률 표시
  - 월별 출결 통계
  - 출석 우수자/경고 대상자 자동 분류
  - 보호자 알림 자동 발송
```

### 4.3 👨‍🏫 강사 관리

#### 4.3.1 강사 등록
```yaml
기본 정보:
  - 이름, 연락처, 이메일
  - 전문 과목 (수학, 영어 등)
  - 자격증 정보
  - 입사일

급여 정보:
  - 급여 정책 선택 (고정급/시급/비율제)
  - 계좌 정보 (급여 지급용)
  - 세율 정보

권한 설정:
  - 담당 반 지정
  - 시스템 권한 부여 (instructor 역할)
```

#### 4.3.2 급여 정책 (schema_v2 기반)
```yaml
정책 유형:
  fixed_monthly: 고정 월급 (예: 250만원)
  fixed_hourly: 시급제 (예: 시간당 3.5만원) 
  commission: 비율제 (예: 매출의 15%)
  tiered_commission: 누진제 (500만원까지 10%, 초과분 15%)
  hybrid: 혼합형 (기본급 180만원 + 매출의 8%)
  guaranteed_minimum: 최소보장 (최소 200만원 보장)

계산 기준:
  - revenue: 담당 반 매출 기준
  - students: 담당 학생 수 기준  
  - hours: 실제 수업 시간 기준
```

### 4.4 💳 결제 관리 (schema_v2 기반)

#### 4.4.1 다양한 수강권 지원
```yaml
월정액권 (monthly):
  - 매월 고정 금액 (예: 18만원)
  - 자동 갱신 옵션
  - 형제 할인 적용 가능

회차권 (sessions):  
  - 정해진 횟수 (예: 10회권, 20회권)
  - 유효 기간 설정 (예: 3개월)
  - 출석 시 자동 차감

시간권 (hours):
  - 정해진 시간 (예: 20시간)
  - 실제 수업 시간에 따라 차감
  - 수업별 시간 입력

패키지권 (package):
  - 장기 할인 (예: 6개월 패키지)
  - 중도 환불 정책 설정

드롭인 (drop_in):
  - 매회 결제
  - 체험 수업용
```

#### 4.4.2 할인 정책
```yaml
형제 할인:
  - 둘째부터 10% 할인
  - 셋째부터 20% 할인
  - 자동 적용

조기 납부 할인:
  - 매월 25일 이전 납부 시 5% 할인
  - 자동 계산 및 적용

장기 수강 할인:
  - 6개월 이상 10% 할인
  - 1년 이상 15% 할인

프로모션 할인:
  - 기간 한정 할인 이벤트
  - 신규 가입 할인
  - 추천인 할인
```

#### 4.4.3 결제 처리
```yaml
결제 방법:
  - 현금
  - 카드 (신용/체크)
  - 계좌 이체
  - 모바일 결제 (향후 확장)

결제 상태:
  - pending: 미납
  - completed: 완납
  - overdue: 연체
  - partial: 부분납부
  - refunded: 환불

미납 관리:
  - 자동 연체료 계산
  - 미납자 목록 자동 생성
  - SMS/이메일 자동 알림
  - 연체 3회 이상 시 수강 제한
```

### 4.5 🔐 권한 관리 (RBAC)

#### 4.5.1 인증 시스템
```yaml
로그인:
  - 이메일/비밀번호 방식
  - Supabase Auth 활용
  - 세션 관리 및 자동 연장

보안:
  - 비밀번호 복잡성 검증
  - 로그인 시도 제한 (5회 실패 시 잠금)
  - 세션 타임아웃 (8시간)
```

#### 4.5.2 권한 제어
```yaml
Row Level Security:
  - 테이블 단위 접근 제어
  - 사용자별 데이터 격리
  - 담당 반/학생만 접근 가능

기능별 권한:
  - 메뉴 단위 접근 제어
  - 버튼 단위 권한 제어
  - API 엔드포인트 권한 검증

감사 로그:
  - 모든 중요 작업 기록
  - 사용자별 활동 추적
  - 데이터 변경 이력 보관
```

---

## 5. 성능 및 기술 요구사항

### 5.1 성능 요구사항
```yaml
응답 시간:
  - 페이지 로딩: < 2초 (첫 방문)
  - 페이지 전환: < 500ms (SPA)
  - API 응답: < 300ms (95%ile)
  - 드래그앤드롭: < 100ms 응답

처리량:
  - 동시 사용자: 50명 이상
  - 학생 데이터: 10,000명 이상 지원
  - 드래그앤드롭: 60fps 유지

메모리:
  - 브라우저 메모리: < 500MB
  - 가상화 활용으로 대용량 데이터 처리
```

### 5.2 호환성 요구사항
```yaml
브라우저:
  데스크톱:
    - Chrome 90+ (권장)
    - Firefox 88+
    - Safari 14+
    - Edge 90+
  
  모바일:
    - iOS Safari 14+
    - Android Chrome 90+

반응형 설계:
  - 데스크톱: 1920x1080 ~ 1280x720
  - 태블릿: 1024x768 ~ 768x1024  
  - 모바일: 375x667 ~ 414x896

접근성:
  - WCAG 2.1 AA 수준 준수
  - 키보드 네비게이션 완전 지원
  - 스크린 리더 최적화
```

### 5.3 보안 요구사항
```yaml
데이터 보안:
  - HTTPS 강제 적용
  - 개인정보 암호화 저장
  - SQL Injection 방지
  - XSS 공격 방지

인증/인가:
  - JWT 토큰 기반 인증
  - 토큰 자동 갱신
  - 세션 하이재킹 방지
  - RBAC 완벽 구현

백업/복구:
  - 일일 자동 백업
  - Point-in-Time Recovery
  - 99.9% 데이터 무결성 보장
```

---

## 6. 확장 기능 (P1)

MVP 이후 단계적으로 추가할 기능들입니다.

### 6.1 우선순위 높음
```yaml
모바일 앱:
  - 학부모용 iOS/Android 앱
  - 출결 알림, 수강료 조회
  - 간편 결제 기능

알림 센터:
  - SMS/이메일 자동 발송
  - 출결, 결제, 공지사항 알림
  - 개인화된 알림 설정

통계 대시보드:
  - 학생/매출 통계 시각화
  - 월별/연도별 트렌드 분석
  - 강사별 성과 분석
```

### 6.2 우선순위 중간  
```yaml
시험 관리:
  - 시험 일정 관리
  - 성적 입력 및 분석
  - 성적표 자동 생성

상담 관리:
  - 상담 예약 시스템
  - 상담 기록 관리
  - 상담 성과 분석

교재 관리:
  - 교재 재고 관리
  - 교재 판매 처리
  - 수익성 분석
```

### 6.3 우선순위 낮음
```yaml
AI 기능:
  - 학생 성과 예측
  - 최적 반 배정 추천
  - 자동 상담 스케줄링

고급 분석:
  - 예측 분석
  - 고객 이탈 예측
  - 수익 최적화 제안

외부 연동:
  - 회계 프로그램 연동
  - 교육청 보고서 자동 생성
  - 타 학원 시스템 데이터 이전
```

---

## 7. 개발 우선순위

### 7.1 1단계 (4주) - 핵심 인프라
```yaml
Week 1-2:
  - 프로젝트 설정 및 인증 시스템
  - 기본 데이터베이스 설정
  - RBAC 기본 구현

Week 3-4:
  - 학생/강사 기본 CRUD
  - 권한별 접근 제어 구현
  - 기본 UI 컴포넌트 개발
```

### 7.2 2단계 (3주) - ClassFlow 구현
```yaml
Week 5-6:
  - 드래그앤드롭 기본 구현
  - 학생 카드 디자인
  - 반 박스 레이아웃

Week 7:
  - 성능 최적화 및 접근성 구현
  - 모바일 대응
  - 테스트 및 버그 수정
```

### 7.3 3단계 (3주) - 결제 시스템
```yaml
Week 8-9:
  - 수강권 시스템 구현 (schema_v2 기반)
  - 할인 정책 적용
  - 결제 처리 로직

Week 10:
  - 미납 관리 시스템
  - 통합 테스트
  - 성능 최적화
```

---

## 8. 검수 기준

### 8.1 기능 검수
- [ ] ClassFlow 드래그앤드롭 완벽 작동
- [ ] 1000명 학생 데이터에서 60fps 유지
- [ ] 모든 권한 시나리오 테스트 통과
- [ ] 결제 프로세스 오류 0건
- [ ] 데이터 무결성 100%

### 8.2 품질 검수  
- [ ] 크로스 브라우저 테스트 통과
- [ ] 모바일/태블릿 반응형 완벽 지원
- [ ] 접근성 테스트 AA 수준 달성
- [ ] 보안 검증 완료
- [ ] 성능 테스트 기준 달성

### 8.3 사용성 검수
- [ ] 신규 사용자 5분 내 기본 조작 습득
- [ ] 직관적 UI/UX 검증
- [ ] 오류 메시지 명확성 확인  
- [ ] 도움말 및 가이드 완성

---

## 결론

EduCanvas v2.0 MVP는 **ClassFlow라는 혁신적인 드래그앤드롭 인터페이스**를 중심으로 학원 운영의 핵심 업무를 간단하고 직관적으로 만드는 것을 목표로 합니다.

### 핵심 성공 요소
1. **🎯 ClassFlow**: 업계 최초 드래그앤드롭 학생 관리
2. **⚡ 성능**: 대용량 데이터에서도 부드러운 60fps
3. **🔐 보안**: 엔터프라이즈급 RBAC 및 데이터 보호  
4. **💳 유연성**: schema_v2 기반 모든 결제 방식 지원
5. **📱 접근성**: 완벽한 모바일/접근성 지원

### 기대 효과
- **학원 운영 효율성 300% 향상**: 직관적 인터페이스로 업무 시간 단축
- **실수 80% 감소**: 드래그앤드롭으로 학생 이동 오류 최소화  
- **사용자 만족도 95% 이상**: 게임같이 재미있는 학원 관리 경험

**다음 단계**: 상세 개발 계획 및 API 명세서 작성